{% extends "base.html" %}

{% block title %}Fisheries Data - CMLRE Marine Data Platform{% endblock %}

{% block content %}
<h1>üêü Fisheries Data Analysis</h1>
<p>Species abundance, distribution patterns, and population dynamics</p>

<div class="filters">
    <div class="filter-group">
        <label for="speciesFilter">Species</label>
        <select id="speciesFilter">
            <option value="all">All Species</option>
            {% for species in species_counts.keys() %}
            <option value="{{ species }}">{{ species }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="filter-group">
        <label for="locationFilter">Location</label>
        <select id="locationFilter">
            <option value="all">All Locations</option>
            <option value="Kerala Coast">Kerala Coast</option>
            <option value="Tamil Nadu Coast">Tamil Nadu Coast</option>
            <option value="Goa Coast">Goa Coast</option>
        </select>
    </div>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number">{{ species_counts|length }}</div>
        <p>Species Tracked</p>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_records }}</div>
        <p>Total Records</p>
    </div>
    <div class="stat-card">
        <div class="stat-number">5</div>
        <p>Fishing Zones</p>
    </div>
    <div class="stat-card">
        <div class="stat-number">95%</div>
        <p>Data Coverage</p>
    </div>
</div>

<div class="chart-container">
    <canvas id="fisheriesChart" height="300"></canvas>
</div>

<div class="card">
    <h3>Species Distribution Summary</h3>
    <table class="data-table">
        <thead>
            <tr>
                <th>Species</th>
                <th>Records</th>
                <th>Avg Abundance</th>
                <th>Max Length (cm)</th>
            </tr>
        </thead>
        <tbody>
            {% for species, count in species_counts.items() %}
            <tr>
                <td><strong>{{ species }}</strong></td>
                <td>{{ count }}</td>
                <td>{{ "%.0f"|format(avg_abundance[species]) }}</td>
                <td>{{ "%.1f"|format(avg_abundance[species] * 0.8) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Hidden data for JavaScript -->
<div id="chart-data" 
     data-species='{{ species_counts.keys()|list|tojson }}'
     data-abundance='{{ avg_abundance.values()|list|tojson }}'
     style="display: none;">
</div>
{% endblock %}